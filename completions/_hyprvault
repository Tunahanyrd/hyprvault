#compdef hyprvault

_hyprvault_sessions() {
    local config_dir="${XDG_CONFIG_HOME:-$HOME/.config}/hyprvault/sessions"
    if [[ -d "$config_dir" ]]; then
        local sessions=(${config_dir}/*.json(N:t:r))
        _describe 'session' sessions
    fi
}

_hyprvault() {
    local -a commands
    commands=(
        'save:Save current session'
        'load:Load a saved session'
        'list:List saved sessions'
        'delete:Delete a session'
        'help:Show help'
    )

    _arguments -C \
        '1: :->command' \
        '2: :->args'

    case $state in
        command)
            _describe 'command' commands
            ;;
        args)
            case $words[2] in
                load|delete)
                    _hyprvault_sessions
                    ;;
            esac
            ;;
    esac
}

_hyprvault "$@"
